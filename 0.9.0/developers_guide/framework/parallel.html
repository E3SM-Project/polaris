

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parallel</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=39bb1c6d"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Provenance" href="provenance.html" />
    <link rel="prev" title="Build utilities" href="build.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Polaris
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/suites.html">Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/mesh/index.html">Mesh component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/seaice/index.html">Sea ice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization/index.html">Organization of Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../e3sm/init/index.html">E3SM initial condition (e3sm/init) component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mesh/index.html">Mesh component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seaice/index.html">Sea ice component</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Framework</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="commands.html">Modules for polaris commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Config files</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpas.html">MPAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="build.html">Build utilities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parallel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#public-api">Public API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-parallel-systems">Supported Parallel Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-support-for-a-new-parallel-system">Adding Support for a New Parallel System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="provenance.html">Provenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="remapping.html">Remapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html#previewing-the-documentation">Previewing the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda_vs_spack.html">How Conda and Spack Work Together in Polaris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../updating_conda.html">Updating Conda Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../updating_spack/index.html">Updating Shared Spack Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_category_of_tasks/index.html">Developer Tutorial: Adding a New Category of Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Polaris</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Framework</a></li>
      <li class="breadcrumb-item active">Parallel</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers_guide/framework/parallel.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="parallel">
<span id="dev-parallel"></span><h1>Parallel<a class="headerlink" href="#parallel" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">polaris.parallel</span></code> module provides a unified interface for querying and managing parallel resources across different computing environments. It abstracts the details of various parallel systems, allowing tasks and steps to request resources and construct parallel execution commands in a system-agnostic way.</p>
<section id="public-api">
<h2>Public API<a class="headerlink" href="#public-api" title="Link to this heading"></a></h2>
<p>The following functions are available in <code class="docutils literal notranslate"><span class="pre">polaris.parallel</span></code>:</p>
<ul class="simple">
<li><p><strong>get_available_parallel_resources(config):</strong>
Returns a dictionary describing the available parallel resources (cores, nodes, cores per node, etc.) for the current environment, as determined by the selected parallel system.</p></li>
<li><p><strong>set_cores_per_node(config, cores_per_node):</strong>
Sets the number of cores per node in the configuration, updating any relevant settings for the current parallel system.</p></li>
<li><p><strong>get_parallel_command(args, cpus_per_task, ntasks, config):</strong>
Returns the command (as a list of strings) to launch a parallel job with the specified arguments, CPUs per task, and number of tasks, using the appropriate parallel launcher for the current system.</p></li>
<li><p><strong>run_command(args, cpus_per_task, ntasks, openmp_threads, config, logger):</strong>
Runs a parallel command with the specified resources and OpenMP thread count, using the appropriate launcher and logging output.</p></li>
</ul>
<p>See also the API documentation for:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../generated/polaris.parallel.get_available_parallel_resources.html#polaris.parallel.get_available_parallel_resources" title="polaris.parallel.get_available_parallel_resources"><code class="xref py py-func docutils literal notranslate"><span class="pre">polaris.parallel.get_available_parallel_resources()</span></code></a></p></li>
<li><p><a class="reference internal" href="../generated/polaris.parallel.set_cores_per_node.html#polaris.parallel.set_cores_per_node" title="polaris.parallel.set_cores_per_node"><code class="xref py py-func docutils literal notranslate"><span class="pre">polaris.parallel.set_cores_per_node()</span></code></a></p></li>
<li><p><a class="reference internal" href="../generated/polaris.parallel.get_parallel_command.html#polaris.parallel.get_parallel_command" title="polaris.parallel.get_parallel_command"><code class="xref py py-func docutils literal notranslate"><span class="pre">polaris.parallel.get_parallel_command()</span></code></a></p></li>
<li><p><a class="reference internal" href="../generated/polaris.parallel.run_command.html#polaris.parallel.run_command" title="polaris.parallel.run_command"><code class="xref py py-func docutils literal notranslate"><span class="pre">polaris.parallel.run_command()</span></code></a></p></li>
</ul>
</section>
<section id="supported-parallel-systems">
<h2>Supported Parallel Systems<a class="headerlink" href="#supported-parallel-systems" title="Link to this heading"></a></h2>
<p>The module currently supports four parallel systems, each with its own resource manager class:</p>
<ul class="simple">
<li><p><strong>single_node:</strong>
For running on a single node, using all available local CPU cores.
Managed by <code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.parallel.SingleNodeSystem</span></code>.</p></li>
<li><p><strong>login:</strong>
For running on a login node (no parallel execution, typically for setup or analysis).
Managed by <code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.parallel.LoginSystem</span></code>.</p></li>
<li><p><strong>slurm:</strong>
For running under the SLURM workload manager, using environment variables and SLURM commands to determine resources.
Managed by <code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.parallel.SlurmSystem</span></code>.</p></li>
<li><p><strong>pbs:</strong>
For running under the PBS workload manager, using environment variables and PBS node files to determine resources.
Managed by <code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.parallel.PbsSystem</span></code>.</p></li>
</ul>
<p>The appropriate system is selected automatically based on the configuration and environment variables.</p>
</section>
<section id="adding-support-for-a-new-parallel-system">
<h2>Adding Support for a New Parallel System<a class="headerlink" href="#adding-support-for-a-new-parallel-system" title="Link to this heading"></a></h2>
<p>To add a new parallel system:</p>
<ol class="arabic simple">
<li><p><strong>Create a new system class:</strong>
Subclass <code class="docutils literal notranslate"><span class="pre">ParallelSystem</span></code> in <code class="docutils literal notranslate"><span class="pre">polaris/parallel/</span></code>, implementing the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_available_resources(self)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_cores_per_node(self,</span> <span class="pre">cores_per_node)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_parallel_command(self,</span> <span class="pre">args,</span> <span class="pre">cpus_per_task,</span> <span class="pre">ntasks)</span></code></p></li>
</ul>
</li>
<li><p><strong>Handle environment detection:</strong>
In your new system class, use environment variables or other mechanisms to detect when your system should be active.</p></li>
<li><p><strong>Register the new system:</strong>
Update the logic in <code class="docutils literal notranslate"><span class="pre">polaris/parallel/__init__.py</span></code> (the <code class="docutils literal notranslate"><span class="pre">_get_system</span></code> function) to recognize your new system based on the config or environment, and return an instance of your new class.</p></li>
<li><p><strong>(Optional) Add documentation:</strong>
Update this documentation page to describe your new system and its usage.</p></li>
</ol>
<p>By following this structure, you can extend Polaris to support additional parallel resource managers or custom environments as needed.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="build.html" class="btn btn-neutral float-left" title="Build utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="provenance.html" class="btn btn-neutral float-right" title="Provenance" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Energy Exascale Earth System Model Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
   

  <!-- Meta tags for JS to use -->
  <meta name="doc-version" content="0.9.0">
  <meta name="doc-site-root" content="../../">

  <!-- Create version switcher container -->
  <script>
    const sidebar = document.querySelector('.wy-side-nav-search');
    if (sidebar) {
      const versionDiv = document.createElement('div');
      versionDiv.id = 'version-switcher';
      versionDiv.style.marginTop = '1em';
      sidebar.appendChild(versionDiv);
    }
  </script>

  <!-- Load version-switcher.js using the correct relative path -->
  <script src="../../../shared/version-switcher.js"></script>


</body>
</html>