

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Categories of tasks</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=7ab3649f" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=3a23cc98"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tasks" href="tasks.html" />
    <link rel="prev" title="Components" href="components.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Polaris
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/suites.html">Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/seaice/index.html">Sea ice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Organization of Tasks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="directories.html">Directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Categories of tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="steps.html">Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="suites.html">Suites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seaice/index.html">SeaIce component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework/index.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Polaris</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Organization of Tasks</a></li>
      <li class="breadcrumb-item active">Categories of tasks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers_guide/organization/categories_of_tasks.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="categories-of-tasks">
<span id="dev-categories-of-tasks"></span><h1>Categories of tasks<a class="headerlink" href="#categories-of-tasks" title="Link to this heading"></a></h1>
<p>There is no formal requirement that tasks be grouped together but it is
typically convenient to do so to keep things organized. Typically, tasks
are placed in a shared subdirectory when they share some conceptual link, serve
a similar purpose or are variants on one another. Often, they have a common
topography and initial condition, perhaps with different mesh resolutions,
parameters, or both.  It is common for tasks with a subdirectory to share
“framework” modules (but contents within a subdirectory of <code class="docutils literal notranslate"><span class="pre">tasks</span></code> should
not be used outside of that subdirectory – framework used more broadly should
belong to the component or polaris as a whole).  Each component will typically
include a mix of “idealized” tasks (e.g. <a class="reference internal" href="../ocean/tasks/baroclinic_channel.html#dev-ocean-baroclinic-channel"><span class="std std-ref">baroclinic_channel</span></a>
or <span class="xref std std-ref">dev-landice-dome</span>) and “realistic”domains (e.g.
<span class="xref std std-ref">dev-landice-greenland</span> and <span class="xref std std-ref">dev-ocean-global-ocean</span>).</p>
<p>Categories of tasks can be grouped in a python package (subdirectory) within
the component’s <code class="docutils literal notranslate"><span class="pre">tasks</span></code> package.  Often, this subdirectory will include a
shared config file, with a set of default config options that are the starting
point for all its tasks.  As an example, here is the config file for the <code class="docutils literal notranslate"><span class="pre">dome</span></code>
test cases in the <code class="docutils literal notranslate"><span class="pre">landice</span></code> core:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># config options for dome tasks</span>
<span class="k">[dome]</span>

<span class="c1"># sizes (in cells) for the 2000m uniform mesh</span>
<span class="na">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">34</span>

<span class="c1"># resolution (in m) for the 2000m uniform mesh</span>
<span class="na">dc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2000.0</span>

<span class="c1"># number of levels in the mesh</span>
<span class="na">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>

<span class="c1"># the dome type (&#39;halfar&#39; or &#39;cism&#39;)</span>
<span class="na">dome_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">halfar</span>

<span class="c1"># Whether to center the dome in the center of the cell that is closest to the</span>
<span class="c1"># center of the domain</span>
<span class="na">put_origin_on_a_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>

<span class="c1"># whether to add a small shelf to the test</span>
<span class="na">shelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>

<span class="c1"># whether to add hydrology to the initial condition</span>
<span class="na">hydro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>

<span class="c1"># config options related to visualization for dome tasks</span>
<span class="k">[dome_viz]</span>

<span class="c1"># which time index to visualize</span>
<span class="na">time_slice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>

<span class="c1"># whether to save image files</span>
<span class="na">save_images</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>

<span class="c1"># whether to hide figures (typically when save_images = True)</span>
<span class="na">hide_figs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>
</pre></div>
</div>
<p>Sometimes these config options are for functionality provided by the component
framework (as is the case for the <code class="docutils literal notranslate"><span class="pre">[vertical_grid]</span></code> config section used by many
task in the <code class="docutils literal notranslate"><span class="pre">ocean</span></code> component).  But most shared config options will typically
go into a section that describes the tasks, as in the <code class="docutils literal notranslate"><span class="pre">[dome]</span></code> example above.
Config options that are specific to a particular step might go into a section
with another name, like the <code class="docutils literal notranslate"><span class="pre">[dome_viz]</span></code> section above.  There is not a
config file specific to a step – all steps in a task share the same config
file.</p>
<p>Typically, in the subdirectory for tasks in a common category, the
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file will be used to define a helper function to add the tasks
to the component.  This helps to keep the constructor of the component itself
from getting too cluttered. As an example, here is a function for adding <code class="docutils literal notranslate"><span class="pre">dome</span></code>
tasks to the <code class="docutils literal notranslate"><span class="pre">landice</span></code> component:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">polaris.landice.tasks.dome.smoke_test</span> <span class="kn">import</span> <span class="n">SmokeTest</span>
<span class="kn">from</span> <span class="nn">polaris.landice.tasks.dome.decomposition_test</span> <span class="kn">import</span> <span class="n">DecompositionTest</span>
<span class="kn">from</span> <span class="nn">polaris.landice.tasks.dome.restart_test</span> <span class="kn">import</span> <span class="n">RestartTest</span>


<span class="k">def</span> <span class="nf">add_dome_tasks</span><span class="p">(</span><span class="n">component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add tasks that define Dome test cases</span>
<span class="sd">    </span>
<span class="sd">    component : polaris.landice.Landice</span>
<span class="sd">        the component that to add the tasks to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">mesh_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2000m&#39;</span><span class="p">,</span> <span class="s1">&#39;variable_resolution&#39;</span><span class="p">]:</span>
        <span class="n">component</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span>
            <span class="n">SmokeTest</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">mesh_type</span><span class="o">=</span><span class="n">mesh_type</span><span class="p">))</span>
        <span class="n">component</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span>
            <span class="n">DecompositionTest</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">mesh_type</span><span class="o">=</span><span class="n">mesh_type</span><span class="p">))</span>
        <span class="n">component</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span>
            <span class="n">RestartTest</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">mesh_type</span><span class="o">=</span><span class="n">mesh_type</span><span class="p">))</span>
</pre></div>
</div>
<p>As in this example, it may be useful to make several
versions of a task by passing different parameters.  In the example, we
create versions of <code class="docutils literal notranslate"><span class="pre">SmokeTest</span></code>, <code class="docutils literal notranslate"><span class="pre">DecompositionTest</span></code> and <code class="docutils literal notranslate"><span class="pre">RestartTest</span></code>
with each of two mesh types (<code class="docutils literal notranslate"><span class="pre">2000m</span></code> and <code class="docutils literal notranslate"><span class="pre">variable_resolution</span></code>).  We will
explore this further when we talk about <a class="reference internal" href="tasks.html#dev-tasks"><span class="std std-ref">Tasks</span></a> and
<a class="reference internal" href="steps.html#dev-steps"><span class="std std-ref">Steps</span></a> below.</p>
<p>It is also sometimes useful to define a common parent task that the tasks in
this category will descend from.  The parent task take cares of setting any
additional config options and other pieces (like common steps) that apply
across all tasks, reducing code redundancy.</p>
<p>As with components and the main <code class="docutils literal notranslate"><span class="pre">polaris</span></code> package, tasks in a common
subdirectory can also have a shared “framework” of packages, modules, config
files, namelists, streams, and YAML files that is shared among tasks and steps.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="components.html" class="btn btn-neutral float-left" title="Components" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tasks.html" class="btn btn-neutral float-right" title="Tasks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Energy Exascale Earth System Model Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="categories_of_tasks.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>