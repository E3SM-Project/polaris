<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ocean framework</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Models" href="models/index.html" />
    <link rel="prev" title="global_convergence" href="test_groups/global_convergence.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Polaris
          </a>
              <div class="version">
                0.1.0-alpha.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_cases.html">Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/test_suites.html">Test Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organization.html">Organization of Tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ocean component</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test_groups/index.html">Test groups</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Ocean framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model">Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-an-e3sm-component">Running an E3SM component</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models/index.html">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../framework.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Polaris</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Ocean component</a></li>
      <li class="breadcrumb-item active">Ocean framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers_guide/ocean/framework.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="ocean-framework">
<span id="dev-ocean-framework"></span><h1>Ocean framework<a class="headerlink" href="#ocean-framework" title="Permalink to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ocean</span></code> component contains an ever expanding set of shared framework code.</p>
<section id="model">
<span id="dev-ocean-model"></span><h2>Model<a class="headerlink" href="#model" title="Permalink to this heading"></a></h2>
<section id="running-an-e3sm-component">
<h3>Running an E3SM component<a class="headerlink" href="#running-an-e3sm-component" title="Permalink to this heading"></a></h3>
<p>Steps that run either Omega or MPAS-Ocean should descend from the
<a class="reference internal" href="generated/polaris.ocean.model.OceanModelStep.html#polaris.ocean.model.OceanModelStep" title="polaris.ocean.model.OceanModelStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.model.OceanModelStep</span></code></a> class.  This class descends
from <a class="reference internal" href="../generated/polaris.ModelStep.html#polaris.ModelStep" title="polaris.ModelStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ModelStep</span></code></a>, so there is a lot of relevant
discussion in <a class="reference internal" href="../framework.html#dev-model"><span class="std std-ref">Model</span></a>.</p>
<section id="yaml-files-vs-namelists-and-streams">
<h4>YAML files vs. namelists and streams<a class="headerlink" href="#yaml-files-vs-namelists-and-streams" title="Permalink to this heading"></a></h4>
<p>In order to have the same test cases support Omega or MPAS-Ocean, we we want
to be able to produce either the YAML config files used by Omega or the
namelists and streams files used by MPAS-Ocean.  To support both, we decided
that polaris would use Omega-style YAML files to configure all test cases and
convert to MPAS-Ocean’s namelists and streams files if needed when steps get
set up.</p>
<p>As a result, the <code class="docutils literal notranslate"><span class="pre">add_namelist_file()</span></code> and <code class="docutils literal notranslate"><span class="pre">add_streams_file()</span></code> methods should
not be used for ocean model steps (they will raise errors).  Similarly,
<a class="reference internal" href="../generated/polaris.ModelStep.update_yaml_at_runtime.html#polaris.ModelStep.update_yaml_at_runtime" title="polaris.ModelStep.update_yaml_at_runtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ModelStep.update_yaml_at_runtime()</span></code></a>,
<a class="reference internal" href="../generated/polaris.ModelStep.update_namelist_at_runtime.html#polaris.ModelStep.update_namelist_at_runtime" title="polaris.ModelStep.update_namelist_at_runtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ModelStep.update_namelist_at_runtime()</span></code></a> and
<a class="reference internal" href="../generated/polaris.ModelStep.update_streams_at_runtime.html#polaris.ModelStep.update_streams_at_runtime" title="polaris.ModelStep.update_streams_at_runtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ModelStep.update_streams_at_runtime()</span></code></a> should not be
used  directly but instead should be accessed through
<a class="reference internal" href="generated/polaris.ocean.model.OceanModelStep.update_model_config_at_runtime.html#polaris.ocean.model.OceanModelStep.update_model_config_at_runtime" title="polaris.ocean.model.OceanModelStep.update_model_config_at_runtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.model.OceanModelStep.update_model_config_at_runtime()</span></code></a>.
This method will call the appropriate method depending on whether the test has
been set up for Omega or MPAS-Ocean.</p>
</section>
<section id="mapping-from-omega-to-mpas-ocean-config-options">
<h4>Mapping from Omega to MPAS-Ocean config options<a class="headerlink" href="#mapping-from-omega-to-mpas-ocean-config-options" title="Permalink to this heading"></a></h4>
<p>As the Omega component is in very early stages of development, we don’t yet
know whether Omega’s config options will always have the same names as the
corresponding namelist options in MPAS-Ocean.  To support the possibility
that they are different, the
<a class="reference internal" href="generated/polaris.ocean.model.OceanModelStep.map_yaml_to_namelist.html#polaris.ocean.model.OceanModelStep.map_yaml_to_namelist" title="polaris.ocean.model.OceanModelStep.map_yaml_to_namelist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.model.OceanModelStep.map_yaml_to_namelist()</span></code></a> method
can be used to translate names of Omega config options to their MPAS-Ocean
counterparts.</p>
</section>
<section id="setting-mpi-resources">
<h4>Setting MPI resources<a class="headerlink" href="#setting-mpi-resources" title="Permalink to this heading"></a></h4>
<p>The target and minimum number of MPI tasks (<code class="docutils literal notranslate"><span class="pre">ntasks</span></code> and <code class="docutils literal notranslate"><span class="pre">min_tasks</span></code>,
respectively) are set automatically if the <code class="docutils literal notranslate"><span class="pre">cell_count</span></code> attribute in in the
ocean model step is set to an approximate number of cells in the mesh.
Sometimes, the number of cells in the mesh is known at setup time (e.g. for
regularly spaced planar meshes, where the number of cells is provided
explicitly).  Often, this is not possible and a more heuristic approach is
needed to estimate the number of cells.  The right approach will need to be
determined on a test case by test case basis.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="test_groups/global_convergence.html" class="btn btn-neutral float-left" title="global_convergence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="models/index.html" class="btn btn-neutral float-right" title="Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Energy Exascale Earth System Model Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="framework.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>