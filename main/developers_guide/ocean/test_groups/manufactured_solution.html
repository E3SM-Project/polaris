<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>manufactured_solution</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="single_column" href="single_column.html" />
    <link rel="prev" title="inertial_gravity_wave" href="inertial_gravity_wave.html" />
    <link href="../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Polaris
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/suites.html">Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/seaice/index.html">Sea ice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../organization/index.html">Organization of Tasks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean component</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Test groups</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_convergence.html">global_convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="inertial_gravity_wave.html">inertial_gravity_wave</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">manufactured_solution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#framework">framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="single_column.html">single_column</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework.html">Ocean framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/index.html">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../seaice/index.html">Seaice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../framework/index.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Polaris</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean component</a></li>
          <li class="breadcrumb-item"><a href="index.html">Test groups</a></li>
      <li class="breadcrumb-item active">manufactured_solution</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developers_guide/ocean/test_groups/manufactured_solution.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="manufactured-solution">
<span id="dev-ocean-manufactured-solution"></span><h1>manufactured_solution<a class="headerlink" href="#manufactured-solution" title="Permalink to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">manufactured_solution</span></code> test group
(<a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.ManufacturedSolution.html#polaris.ocean.tasks.manufactured_solution.ManufacturedSolution" title="polaris.ocean.tasks.manufactured_solution.ManufacturedSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.ManufacturedSolution</span></code></a>)
implements a test case according to the Method of Manufactured Solutions
(see <a class="reference internal" href="../../../users_guide/ocean/test_groups/manufactured_solution.html#ocean-manufactured-solution"><span class="std std-ref">manufactured_solution</span></a>) at 4 resolutions (200, 100, 50, and 25 km).  Here,
we describe the shared framework for this test group and the 1 test case.</p>
<section id="framework">
<span id="id1"></span><h2>framework<a class="headerlink" href="#framework" title="Permalink to this heading"></a></h2>
<p>The shared config options for the <code class="docutils literal notranslate"><span class="pre">manufactured_solution</span></code> test group
are described in <a class="reference internal" href="../../../users_guide/ocean/test_groups/manufactured_solution.html#ocean-manufactured-solution"><span class="std std-ref">manufactured_solution</span></a> in the User’s Guide.</p>
<p>Additionally, the test group has a shared <code class="docutils literal notranslate"><span class="pre">forward.yaml</span></code> file with
a few common model config options related to run duration and default
horizontal  and vertical momentum and tracer diffusion, as well as defining
<code class="docutils literal notranslate"><span class="pre">mesh</span></code>, <code class="docutils literal notranslate"><span class="pre">input</span></code>, <code class="docutils literal notranslate"><span class="pre">restart</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code> streams.</p>
<section id="exact-solution">
<h3>exact_solution<a class="headerlink" href="#exact-solution" title="Permalink to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution.html#polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution" title="polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution</span></code></a>
defines a class for storing attributes and methods relevant to computing the
exact manufactured solution.  The constructor obtains the parameters from the
config file. The
<code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution.ssh(t)()</span></code>
method computes the SSH field at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.  The
<code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.exact_solution.ExactSolution.normalVelocity(t)()</span></code>
method computes the <code class="docutils literal notranslate"><span class="pre">normalVelocity</span></code> field at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</section>
<section id="init">
<h3>init<a class="headerlink" href="#init" title="Permalink to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.init.Init.html#polaris.ocean.tasks.manufactured_solution.init.Init" title="polaris.ocean.tasks.manufactured_solution.init.Init"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.init.Init</span></code></a>
defines a step for setting up the initial state for each test case.</p>
<p>First, a mesh appropriate for the resolution is generated using
<a class="reference external" href="http://mpas-dev.github.io/MPAS-Tools/stable/generated/mpas_tools.planar_hex.make_planar_hex_mesh.html#mpas_tools.planar_hex.make_planar_hex_mesh" title="(in mpas_tools vstable)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.planar_hex.make_planar_hex_mesh()</span></code></a>.  Then, the mesh is
culled to remove periodicity in the y direction.  A vertical grid is generated
with 1 layer.  Finally, the initial layerThickness field is computed from the
exact solution for the SSH field and the initial velocity is also assigned to
the exact solution. The tracer and coriolis fields are uniform in space.</p>
</section>
<section id="forward">
<h3>forward<a class="headerlink" href="#forward" title="Permalink to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.forward.Forward.html#polaris.ocean.tasks.manufactured_solution.forward.Forward" title="polaris.ocean.tasks.manufactured_solution.forward.Forward"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.forward.Forward</span></code></a>
defines a step for running MPAS-Ocean from the initial condition produced in
the <code class="docutils literal notranslate"><span class="pre">init</span></code> step.  Namelist and streams files are updated in
<a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.forward.Forward.dynamic_model_config.html#polaris.ocean.tasks.manufactured_solution.forward.Forward.dynamic_model_config" title="polaris.ocean.tasks.manufactured_solution.forward.Forward.dynamic_model_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.forward.Forward.dynamic_model_config()</span></code></a>
with time steps determined algorithmically based on config options.  The
number of cells is approximated from config options in
<a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.forward.Forward.compute_cell_count.html#polaris.ocean.tasks.manufactured_solution.forward.Forward.compute_cell_count" title="polaris.ocean.tasks.manufactured_solution.forward.Forward.compute_cell_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.forward.Forward.compute_cell_count()</span></code></a>
so that this can be used to constrain the number of MPI tasks that Polaris tasks
have as their target and minimum (if the resources are not explicitly
prescribed).  For MPAS-Ocean, PIO namelist options are modified and a
graph partition is generated as part of <code class="docutils literal notranslate"><span class="pre">runtime_setup()</span></code>.  Finally, the ocean
model is run.</p>
</section>
<section id="analysis">
<h3>analysis<a class="headerlink" href="#analysis" title="Permalink to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.analysis.Analysis.html#polaris.ocean.tasks.manufactured_solution.analysis.Analysis" title="polaris.ocean.tasks.manufactured_solution.analysis.Analysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.analysis.Analysis</span></code></a>
defines a step for computing the root mean-square-error from the final
simulated field and the exact solution. It uses the config options to determine
whether the convergence rate falls within acceptable bounds.</p>
</section>
<section id="viz">
<h3>viz<a class="headerlink" href="#viz" title="Permalink to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.viz.Viz.html#polaris.ocean.tasks.manufactured_solution.viz.Viz" title="polaris.ocean.tasks.manufactured_solution.viz.Viz"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.viz.Viz</span></code></a>
defines a step for visualization. It produces two plots: the convergence of the
RMSE with resolution and a plan-view of the simulated, exact, and (simulated -
exact) SSH fields.</p>
</section>
<section id="convergence">
<span id="dev-ocean-manufactured-solution-convergence"></span><h3>convergence<a class="headerlink" href="#convergence" title="Permalink to this heading"></a></h3>
<p>The <a class="reference internal" href="../generated/polaris.ocean.tasks.manufactured_solution.convergence.Convergence.html#polaris.ocean.tasks.manufactured_solution.convergence.Convergence" title="polaris.ocean.tasks.manufactured_solution.convergence.Convergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.manufactured_solution.convergence.Convergence</span></code></a>
test performs a 10-hour run.  Then, validation of <code class="docutils literal notranslate"><span class="pre">temperature</span></code>,
<code class="docutils literal notranslate"><span class="pre">layerThickness</span></code> and <code class="docutils literal notranslate"><span class="pre">normalVelocity</span></code> are performed against a
baseline if one is provided when calling <a class="reference internal" href="../../command_line.html#dev-polaris-setup"><span class="std std-ref">polaris setup</span></a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="inertial_gravity_wave.html" class="btn btn-neutral float-left" title="inertial_gravity_wave" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="single_column.html" class="btn btn-neutral float-right" title="single_column" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Energy Exascale Earth System Model Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="manufactured_solution.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>