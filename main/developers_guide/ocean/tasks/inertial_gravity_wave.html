

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>inertial_gravity_wave</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=b208ceb8"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="internal_wave" href="internal_wave.html" />
    <link rel="prev" title="ice_shelf_2d" href="ice_shelf_2d.html" />
    <link href="../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Polaris
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/quick_start.html">Quick Start for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/config_files.html">Config Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/suites.html">Suites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/ocean/index.html">Ocean component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/seaice/index.html">Sea ice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users_guide/machines/index.html">Machines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../organization/index.html">Organization of Tasks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Ocean component</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Tasks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="baroclinic_channel.html">baroclinic_channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="barotropic_gyre.html">barotropic_gyre</a></li>
<li class="toctree-l3"><a class="reference internal" href="correlated_tracers_2d.html">correlated_tracers_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="cosine_bell.html">cosine_bell</a></li>
<li class="toctree-l3"><a class="reference internal" href="geostrophic.html">geostrophic</a></li>
<li class="toctree-l3"><a class="reference internal" href="divergent_2d.html">divergent_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="ice_shelf_2d.html">ice_shelf_2d</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">inertial_gravity_wave</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#framework">framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="internal_wave.html">internal_wave</a></li>
<li class="toctree-l3"><a class="reference internal" href="manufactured_solution.html">manufactured_solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="nondivergent_2d.html">nondivergent_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="rotation_2d.html">rotation_2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="single_column.html">single_column</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../framework.html">Ocean framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/index.html">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../seaice/index.html">SeaIce component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../framework/index.html">Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../machines/index.html">Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploying_spack.html">Deploying a new spack environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/dev_add_test_group.html">Developer Tutorial: Adding a new test group</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Polaris</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ocean component</a></li>
          <li class="breadcrumb-item"><a href="index.html">Tasks</a></li>
      <li class="breadcrumb-item active">inertial_gravity_wave</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developers_guide/ocean/tasks/inertial_gravity_wave.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="inertial-gravity-wave">
<span id="dev-ocean-inertial-gravity-wave"></span><h1>inertial_gravity_wave<a class="headerlink" href="#inertial-gravity-wave" title="Link to this heading"></a></h1>
<p>The inertial gravity wave test in <code class="docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave</span></code>
is a linear shallow water test case at 4 resolutions (200, 100, 50, and
25 km).</p>
<p>The <a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.InertialGravityWave.html#polaris.ocean.tasks.inertial_gravity_wave.InertialGravityWave" title="polaris.ocean.tasks.inertial_gravity_wave.InertialGravityWave"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.InertialGravityWave</span></code></a>
test performs a 10-hour run with a series of resolutions.  The convergence rate
is calculated and visualizations are generated.</p>
<section id="framework">
<h2>framework<a class="headerlink" href="#framework" title="Link to this heading"></a></h2>
<p>The config options for the <code class="docutils literal notranslate"><span class="pre">inertial_gravity_wave</span></code> test are described in
<a class="reference internal" href="../../../users_guide/ocean/tasks/inertial_gravity_wave.html#ocean-inertial-gravity-wave"><span class="std std-ref">inertial gravity wave</span></a> in the User’s Guide.</p>
<p>Additionally, the test uses a <code class="docutils literal notranslate"><span class="pre">forward.yaml</span></code> file with a few common
model config options related to run duration and default horizontal and
vertical momentum and tracer diffusion, as well as defining <code class="docutils literal notranslate"><span class="pre">mesh</span></code>, <code class="docutils literal notranslate"><span class="pre">input</span></code>,
<code class="docutils literal notranslate"><span class="pre">restart</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code> streams.</p>
<section id="exact-solution">
<h3>exact_solution<a class="headerlink" href="#exact-solution" title="Link to this heading"></a></h3>
<p>The class
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.html#polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution" title="polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution</span></code></a>
defines a class for storing attributes and methods relevant to computing the
exact solution.  The constructor obtains the parameters from the config file.
The
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.ssh.html#polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.ssh" title="polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.ssh"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.ssh()</span></code></a>
method computes the SSH field.  The
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.normal_velocity.html#polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.normal_velocity" title="polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.normal_velocity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.exact_solution.ExactSolution.normal_velocity()</span></code></a>
method computes the <code class="docutils literal notranslate"><span class="pre">normalVelocity</span></code> field.</p>
</section>
<section id="init">
<h3>init<a class="headerlink" href="#init" title="Link to this heading"></a></h3>
<p>The class
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.init.Init.html#polaris.ocean.tasks.inertial_gravity_wave.init.Init" title="polaris.ocean.tasks.inertial_gravity_wave.init.Init"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.init.Init</span></code></a>
defines a step for setting up the initial state for each test case.</p>
<p>First, a mesh appropriate for the resolution is generated using
<a class="reference external" href="https://mpas-dev.github.io/MPAS-Tools/master/generated/mpas_tools.planar_hex.make_planar_hex_mesh.html#mpas_tools.planar_hex.make_planar_hex_mesh" title="(in mpas_tools v0.36.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpas_tools.planar_hex.make_planar_hex_mesh()</span></code></a>.  Then, the mesh is
culled to remove periodicity in the y direction.  A vertical grid is generated
with 1 layer.  Finally, the initial layerThickness field is computed from the
exact solution for the SSH field and the initial velocity is also assigned to
the exact solution. The tracer and coriolis fields are uniform in space.</p>
</section>
<section id="forward">
<h3>forward<a class="headerlink" href="#forward" title="Link to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.forward.Forward.html#polaris.ocean.tasks.inertial_gravity_wave.forward.Forward" title="polaris.ocean.tasks.inertial_gravity_wave.forward.Forward"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.forward.Forward</span></code></a>
descends from
<code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.convergence.ConvergenceForward</span></code>
and runs MPAS-Ocean from the initial condition produced in the <code class="docutils literal notranslate"><span class="pre">init</span></code> step.
Namelist and streams files are updated by the parent class with time steps
determined algorithmically based on config options. The number
of cells is approximated from config options in
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.forward.Forward.compute_cell_count.html#polaris.ocean.tasks.inertial_gravity_wave.forward.Forward.compute_cell_count" title="polaris.ocean.tasks.inertial_gravity_wave.forward.Forward.compute_cell_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.forward.Forward.compute_cell_count()</span></code></a>
so that this can be used to constrain the number of MPI tasks that Polaris
tasks have as  their target and minimum (if the resources are not explicitly
prescribed).  For MPAS-Ocean, PIO namelist options are modified and a graph
partition is generated as part of <code class="docutils literal notranslate"><span class="pre">runtime_setup()</span></code>.  Then, the ocean model
is run. Finally, validation of <code class="docutils literal notranslate"><span class="pre">layerThickness</span></code> and <code class="docutils literal notranslate"><span class="pre">normalVelocity</span></code> are
performed against a baseline if one is provided when calling
<a class="reference internal" href="../../command_line.html#dev-polaris-setup"><span class="std std-ref">polaris setup</span></a>.</p>
</section>
<section id="analysis">
<h3>analysis<a class="headerlink" href="#analysis" title="Link to this heading"></a></h3>
<p>The class
<a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.analysis.Analysis.html#polaris.ocean.tasks.inertial_gravity_wave.analysis.Analysis" title="polaris.ocean.tasks.inertial_gravity_wave.analysis.Analysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.analysis.Analysis</span></code></a>
descends from <a class="reference internal" href="../generated/polaris.ocean.convergence.analysis.ConvergenceAnalysis.html#polaris.ocean.convergence.analysis.ConvergenceAnalysis" title="polaris.ocean.convergence.analysis.ConvergenceAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.convergence.analysis.ConvergenceAnalysis</span></code></a>
a step for computing the error from the final simulated field
and the exact solution. It uses the config options to determine whether the
convergence rate falls within acceptable bounds.</p>
</section>
<section id="viz">
<h3>viz<a class="headerlink" href="#viz" title="Link to this heading"></a></h3>
<p>The class <a class="reference internal" href="../generated/polaris.ocean.tasks.inertial_gravity_wave.viz.Viz.html#polaris.ocean.tasks.inertial_gravity_wave.viz.Viz" title="polaris.ocean.tasks.inertial_gravity_wave.viz.Viz"><code class="xref py py-class docutils literal notranslate"><span class="pre">polaris.ocean.tasks.inertial_gravity_wave.viz.Viz</span></code></a> defines
a step for visualization. It produces a plan-view figure of the simulated,
exact, and (simulated - exact) SSH fields.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ice_shelf_2d.html" class="btn btn-neutral float-left" title="ice_shelf_2d" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="internal_wave.html" class="btn btn-neutral float-right" title="internal_wave" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Energy Exascale Earth System Model Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../../0.5.0/index.html">0.5.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="inertial_gravity_wave.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>